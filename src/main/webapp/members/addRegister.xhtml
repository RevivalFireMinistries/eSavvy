<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                template="#{request.contextPath}/template.xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:define name="content">
        <h:form id="form">
            <p:fieldset legend="Event Attendance Register">
                <p:panelGrid columns="4">
                    <f:facet name="header">
                        Event Information
                    </f:facet>

                    <h:outputLabel  style="font-weight:bold" value="Name of Event: " />
                    <h:outputText value="#{attendance.event.eventType}" />


                    <h:outputLabel  style="font-weight:bold" value="Date: " />
                    <h:outputText value="#{attendance.event.eventDateFormatted}" />

                    <h:outputLabel  style="font-weight:bold" value="Target Attendance: " />
                    <h:outputText value="#{attendance.event.targetAttendance}" />

                    <h:outputLabel  style="font-weight:bold" value="Leader's Comment: " />
                    <h:outputText value="#{attendance.event.comment}" />
                    <h:outputLabel  style="font-weight:bold" value="Total Registered: " />
                    <h:outputText value="#{attendance.event.totalRegistered}" />

                    <h:outputLabel  style="font-weight:bold" value="% Present: " />
                    <h:outputText value="#{attendance.event.percentagePresent}" />

                    <f:facet name="footer">

                    </f:facet>
                </p:panelGrid>
                <h:panelGrid columns="2" cellpadding="10">
            <p:dataTable id="members" var="member" value="#{attendance.memberDataModel}" paginator="true" rows="10"
                     selection="#{attendance.selectedMembers}">

            <f:facet name="header">
                Please tick on all the members who were present
            </f:facet>

            <p:column selectionMode="multiple" style="width:2%" />

            <p:column headerText="Member's Name" style="width:25%">
                #{member.fullName}
            </p:column>

            <p:column headerText="Member Type" style="width:25%">
                #{member.type}
            </p:column>

            <p:column headerText="Status" style="width:24%">
                #{member.status}
            </p:column>



            <f:facet name="footer">
                <p:commandButton id="present" value="Submit Register" icon="ui-icon-search"
                             actionListener="#{attendance.processRegister}"    update=":form:multiDialog" oncomplete="PF('reportSummary').show()"/>
            </f:facet>
        </p:dataTable>
            </h:panelGrid>
            </p:fieldset>
            <p:dialog id="multiDialog" header="Report Summary" widgetVar="reportSummary"
                      height="600" width="700" showEffect="fade" hideEffect="explode">


                    <p:panelGrid columns="2" >
                        <f:facet name="header">
                            <p:messages id="msgs"/>
                        </f:facet>

                        <h:outputLabel  style="font-weight:bold" value="Target Attendance: " />
                        <h:outputText value="#{attendance.event.targetAttendance}" />
                        <h:outputLabel  style="font-weight:bold" value="Total Registered: " />
                        <h:outputText value="#{attendance.event.totalRegistered}" />
                        <h:outputLabel  style="font-weight:bold" value="Actual Attendance: " />
                        <h:outputText value="#{attendance.event.attendance}" />
                        <h:outputLabel  style="font-weight:bold" value="% Present: " />
                        <h:outputText value="#{attendance.event.percentagePresent}" />
                        <h:outputLabel  style="font-weight:bold" value="% Present: " />
                        <h:outputText value="#{attendance.event.percentageAbsent}" />


                        <f:facet name="footer">

                        </f:facet>
                    </p:panelGrid>
                        <h:form>

                        <p:dataTable var="m" value="#{attendance.assemblyFollowUpList}" id="followup">

                            <f:facet name="header">
                                Absent Members
                            </f:facet>
                        <p:column headerText="Full Name">
                            <h:outputText value="#{m.member.fullName}" />
                        </p:column>
                            <p:column headerText="Phone">
                                <h:outputText value="#{m.member.phone}" />
                            </p:column>
                            <p:column headerText="Date Last @ Church">
                                <h:outputText value="#{m.dateCreated}" />
                            </p:column>
                        </p:dataTable>
                            <h:commandButton value="Print Report" type="button" icon="ui-icon-print">
                                <p:printer target="followup" />
                            </h:commandButton>
                        </h:form>



            </p:dialog>
        </h:form>
    </ui:define>
</ui:composition>